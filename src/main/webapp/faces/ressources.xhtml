<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
   <title>Ressources Page</title>
   <meta  name="viewport" content="width=device-width, initial-scale=1" http-equiv="X-UA-Conpatible" />
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" />
   <link rel="stylesheet" href="../WEB-INF/lib/register.css" />
   <script type="text/javascript">
   function toggle(id) {
      var e = document.getElementById(id);
      if (e.style.display == 'block' || e.style.display == '') {
         e.style.display = 'none';
      } else {
         e.style.display = 'block';
      }
   }
</script>
</h:head>
<h:body>
   <c:choose>
      <c:when test="#{session.getAttribute('role')=='user'}">
         <f:view>
            <div style="background-color: #eee;">
               <div class="text-center container py-5">

                  <h:form>
                     <h:commandButton style="position: absolute ;
            left: 50px;
            top: 100px;
            " class="btn btn-primary btn mb-1" value="Disponibles" actionListener="#{amphis.processConsoleAction}" />
                     <h:commandButton style="position: absolute ;
            left: 170px;
            top: 100px;" class="btn btn-primary btn mb-1" value="Réservés" actionListener="#{amphis.processConsoleAction}" />
                  </h:form>


                  <h4 class="mt-4 mb-5"><strong>Ressources</strong></h4>

                  <div class="row">
                     <c:forEach var="ressource" items="#{ressources.getRessources()}" >
                        <div class="col-lg-4 col-md-12 mb-4">
                           <div class="card" >
                              <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light">
                                 <img src="#{ressource.image}" class="w-100" height="250" alt="image amphi"/>
                                 <a href="#!">
                                    <div class="mask">
                                       <div class="d-flex justify-content-start align-items-end h-100">
                                          <h5><span class="#{ressource.available?'badge ms-2 badge-primary':'badge ms-2 badge-danger'}">#{ressource.available?"available":"non available"}</span></h5>
                                       </div>
                                    </div>

                                 </a>
                              </div>
                              <div class="card-body">
                                 <a href="" class="text-reset">
                                    <h5 class="card-title mb-3">#{ressource.nom}</h5>
                                 </a>
                                 <a href="" class="text-reset">
                                    <p>Departement:#{ressource.departement}</p>
                                 </a>
                                 <a href="" class="text-reset">
                                    <p>Type:#{ressource.type}</p>
                                 </a>
                                 <h6 class="mb-3"> </h6>

                              </div>
                              <div class="card-action">
                                 <h:form>
                                    <h:commandButton class="#{ressource.available?'btn btn-success btn mb-1 ml-1':'btn btn-secondary btn mb-1 ml-1'}" value="#{ressource.available?'reservé':'annuller'}"
                                                     action="#{ressources.processConsoleActionMakeReservation(ressource.nom,ressource.available)}"/>

                                 </h:form>
                                 <button class="btn btn-warning btn mb-1 ml-1" onclick = "toggle('recalamation');"  type="button">Reclamer</button>
                                 <h:form style="display: none;" id="recalamation" >

                                    <div class="form-outline mb-4">
                                       <label class="form-label" for="message">Message</label>
                                       <h:inputTextarea id="message" value="#{reclamation.message}" class="form-control form-control-lg">
                                       </h:inputTextarea>
                                       <h:message for="message">
                                       </h:message>
                                    </div>


                                    <div class="pt-1 mb-4">
                                       <h:commandButton action="#{reclamation.sendMessage()}"
                                                        value="Envoyer" class="btn btn-info btn-lg btn-block">
                                       </h:commandButton>
                                    </div>

                                 </h:form>
                              </div>
                           </div>
                        </div>

                     </c:forEach>
                  </div>
               </div>
            </div>
         </f:view>
      </c:when>
      <c:otherwise>
         <f:view>
            <div style="background-color: #eee;">
               <div class="text-center container py-5">

                  <h:form>
                     <h:commandButton style="position: absolute ;
            left: 50px;
            top: 100px;
            " class="btn btn-primary btn mb-1" value="Disponibles" actionListener="#{amphis.processConsoleAction}" />
                     <h:commandButton style="position: absolute ;
            left: 170px;
            top: 100px;" class="btn btn-primary btn mb-1" value="Réservés" actionListener="#{amphis.processConsoleAction}" />
                  </h:form>


                  <h4 class="mt-4 mb-5"><strong>Ressources</strong></h4>

                  <div class="row">
                     <c:forEach var="ressource" items="#{ressources.getRessources()}" >
                        <div class="col-lg-4 col-md-12 mb-4">
                           <div class="card" >
                              <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light">
                                 <img src="#{ressource.image}" class="w-100" height="250" alt="image amphi"/>
                                 <a href="#!">
                                    <div class="mask">
                                       <div class="d-flex justify-content-start align-items-end h-100">
                                          <h5><span class="#{ressource.available?'badge ms-2 badge-primary':'badge ms-2 badge-danger'}">#{ressource.available?"available":"non available"}</span></h5>
                                       </div>
                                    </div>

                                 </a>
                              </div>
                              <div class="card-body">
                                 <a href="" class="text-reset">
                                    <h5 class="card-title mb-3">#{ressource.nom}</h5>
                                 </a>
                                 <a href="" class="text-reset">
                                    <p>Departement:#{ressource.departement}</p>
                                 </a>
                                 <a href="" class="text-reset">
                                    <p>Type:#{ressource.type}</p>
                                 </a>
                                 <h6 class="mb-3"> </h6>
                              </div>
                              <div class="card-action">
                                 <h:form>
                                    <h:commandButton class="btn btn-primary btn mb-1" value="#{ressource.available?'reservé':'annuller'}"
                                                     action="#{ressources.processConsoleActionMakeReservation(ressource.nom,ressource.available)}"/>
                                    <h:commandButton class="#{ressource.available?'btn btn-warning btn mb-1 ml-1':'btn btn-danger btn mb-1 ml-1'}" value="#{ressource.available?'supprimer':'vous devez pas supprimez une salle réserve'}"
                                                     action="#{ressources.processConsoleActionDeleteResources(amphi.nom,amphi.available)}"/>
                                 </h:form>

                              </div>
                           </div>
                        </div>

                     </c:forEach>
                     <h:form>
                        <h:commandLink  class="btn btn-success fixed-bottom" action="#{login.reroute('addRessource')}" value="Ajouter Ressource"/>
                     </h:form>
                  </div>
               </div>
            </div>
         </f:view>
      </c:otherwise>
   </c:choose>

</h:body>
</html>
